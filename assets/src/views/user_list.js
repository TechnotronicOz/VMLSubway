// Generated by CoffeeScript 1.4.0
var UserListView, UserView;

UserView = Backbone.View.extend({
  initialize: function(user) {
    return this.user = user;
  },
  className: 'userlist_user',
  render: function() {
    $(this.el).html(ich.userlist_user(this.user.model.attributes));
    return this;
  },
  addToIdle: function() {
    var idleTime;
    idleTime = this.user.model.get('idle') + 1;
    if (idleTime > 60) {
      this.user.model.set({
        activity: '',
        user_status: 'idle'
      });
      clearInterval(this.intervalTimer);
    } else {
      this.user.model.set({
        activity: '(' + idleTime + 'm)',
        idle: idleTime,
        user_status: 'active'
      });
      if (this.intervalTimer === void 0) {
        this.setStatus();
      }
    }
    return this.render();
  },
  setStatus: function() {
    var interval, self;
    self = this;
    interval = 60 * 1000;
    return this.intervalTimer = setInterval(function() {
      return self.addToIdle();
    }, interval);
  }
});

UserListView = Backbone.View.extend({
  initialize: function() {
    this.setElement(this.collection.channel.view.$('#user-list'));
    return this.collection.bind('add', this.add, this);
  },
  render: function() {
    return this;
  },
  add: function(user) {
    var userView;
    userView = new UserView({
      model: User
    });
    User.view = userView;
    return $(this.el).append(userView.render().el);
  }
});
